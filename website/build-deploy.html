<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SLightSFTP Build & Deploy (Windows / Linux / macOS)</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/png" href="icon.png">
</head>
<body>
    <div class="main-content-wrapper">
        <nav class="navbar">
            <div class="container">
                <div class="nav-brand">
                    <img src="icon.png" alt="SLightSFTP Logo" class="logo">
                    <span>SLightSFTP</span>
                    <span class="free-badge">FREE</span>
                </div>
                <ul class="nav-links">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="#prereqs">Prereqs</a></li>
                    <li><a href="#build">Build</a></li>
                    <li><a href="#run">Run</a></li>
                    <li><a href="#package">Package</a></li>
                    <li><a href="#service">Service</a></li>
                </ul>
            </div>
        </nav>

        <section class="architecture" id="prereqs">
            <div class="container">
                <h2>Prerequisites</h2>
                <div class="architecture-grid">
                    <div class="architecture-card">
                        <h3>Common</h3>
                        <ul>
                            <li>Node.js 18+ LTS</li>
                            <li>npm 9+ (bundled with Node)</li>
                            <li>Git (optional, to clone repo)</li>
                        </ul>
                    </div>
                    <div class="architecture-card">
                        <h3>Windows</h3>
                        <ul>
                            <li>PowerShell 5.1+ or PowerShell 7</li>
                            <li>Build tools: <code>windows-build-tools</code> if native deps are added later</li>
                            <li>MSI packaging uses existing scripts in repo</li>
                        </ul>
                    </div>
                    <div class="architecture-card">
                        <h3>Linux</h3>
                        <ul>
                            <li>Debian/Ubuntu: <code>sudo apt install build-essential</code></li>
                            <li>CentOS/RHEL: <code>sudo yum groupinstall \"Development Tools\"</code></li>
                            <li>Systemd available for service mode</li>
                        </ul>
                    </div>
                    <div class="architecture-card">
                        <h3>macOS</h3>
                        <ul>
                            <li>Xcode Command Line Tools: <code>xcode-select --install</code></li>
                            <li>Homebrew (optional) for Node install</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <section class="architecture" id="build">
            <div class="container">
                <h2>Build (TypeScript)</h2>
                <div class="architecture-subgrid">
                    <div class="architecture-card">
                        <h3>Install deps</h3>
<pre class="diagram">
npm install
</pre>
                    </div>
                    <div class="architecture-card">
                        <h3>Compile TS â†’ JS</h3>
<pre class="diagram">
npm run build
# runs tsc using tsconfig.json
</pre>
                    </div>
                    <div class="architecture-card">
                        <h3>Lint/Tests</h3>
<pre class="diagram">
# (if configured)
npm test
</pre>
                        <p class="note">Integration tests may require SFTP/FTP listeners; run on a dev machine.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="architecture" id="run">
            <div class="container">
                <h2>Run (Cross-Platform)</h2>
                <div class="architecture-subgrid">
                    <div class="architecture-card">
                        <h3>Desktop GUI (Electron)</h3>
<pre class="diagram">
# Windows/macOS/Linux (X11/Wayland)
npm run start:desktop
</pre>
                        <p>Runs Electron app with embedded SFTP/FTP listeners.</p>
                    </div>
                    <div class="architecture-card">
                        <h3>Web Server Mode</h3>
<pre class="diagram">
# headless-friendly
npm run start:web
# or built output
node dist/web-only.js
</pre>
                        <p>Serve the web GUI + API. Point browser to <code>http://localhost:3000</code> (or your port).</p>
                    </div>
                    <div class="architecture-card">
                        <h3>Server Only</h3>
<pre class="diagram">
node dist/server-only.js
</pre>
                        <p>Runs listeners without GUI; manage via API/Web when paired with <code>start:web</code>.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="architecture" id="package">
            <div class="container">
                <h2>Package</h2>
                <div class="architecture-grid">
                    <div class="architecture-card">
                        <h3>Windows (MSI)</h3>
                        <ul>
                            <li>Uses existing build scripts in <code>release/</code></li>
                            <li>Run packaging script (documented in repo)</li>
                            <li>Outputs MSI in <code>release/</code> or <code>dist/</code></li>
                        </ul>
                    </div>
                    <div class="architecture-card">
                        <h3>Linux (AppImage/zip)</h3>
                        <ul>
                            <li>Package options: electron-builder AppImage</li>
                            <li>Or ship as zipped Node bundle + systemd unit</li>
                            <li>Example: <code>npm run build && tar -czf slightsftp-linux.tar.gz dist</code></li>
                        </ul>
                    </div>
                    <div class="architecture-card">
                        <h3>macOS (.app/.dmg)</h3>
                        <ul>
                            <li>Use electron-builder targets: <code>--mac dmg</code></li>
                            <li>Requires Apple signing for distribution</li>
                            <li>Local dev: unsigned build works with gatekeeper override</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <section class="architecture" id="service">
            <div class="container">
                <h2>Service / Daemon Setup</h2>
                <div class="architecture-subgrid">
                    <div class="architecture-card">
                        <h3>Windows (NSSM example)</h3>
<pre class="diagram">
# install nssm first
nssm install SLightSFTP "C:\\Program Files\\nodejs\\node.exe" dist/web-only.js
nssm set SLightSFTP AppDirectory C:\\path\\to\\slightsftp
nssm set SLightSFTP Start SERVICE_AUTO_START
</pre>
                        <p>Use a service account with least privilege and open needed ports.</p>
                    </div>
                    <div class="architecture-card">
                        <h3>Linux (systemd)</h3>
<pre class="diagram">
[Unit]
Description=SLightSFTP Web
After=network.target

[Service]
WorkingDirectory=/opt/slightsftp
ExecStart=/usr/bin/node dist/web-only.js
Restart=on-failure
User=slightsftp
Group=slightsftp

[Install]
WantedBy=multi-user.target
</pre>
                        <p>Enable/start: <code>sudo systemctl enable --now slightsftp.service</code>.</p>
                    </div>
                    <div class="architecture-card">
                        <h3>macOS (launchd)</h3>
<pre class="diagram">
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
  <key>Label</key><string>com.slighsftp.web</string>
  <key>ProgramArguments</key>
  <array>
    <string>/usr/local/bin/node</string>
    <string>/Users/you/slightsftp/dist/web-only.js</string>
  </array>
  <key>RunAtLoad</key><true/>
  <key>KeepAlive</key><true/>
  <key>WorkingDirectory</key><string>/Users/you/slightsftp</string>
  <key>StandardOutPath</key><string>/tmp/slightsftp.out.log</string>
  <key>StandardErrorPath</key><string>/tmp/slightsftp.err.log</string>
</dict>
</plist>
</pre>
                        <p>Load: <code>launchctl load ~/Library/LaunchAgents/com.slighsftp.web.plist</code></p>
                    </div>
                </div>
            </div>
        </section>

        <footer class="footer">
            <div class="container">
                <div class="footer-bottom">
                    <p>&copy; 2025 SLightSFTP Server. Free and Open Source Software.</p>
                    <p><a href="index.html">Back to Home</a></p>
                </div>
            </div>
        </footer>
    </div>
</body>
</html>
